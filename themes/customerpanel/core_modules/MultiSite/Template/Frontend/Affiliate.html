<div id="multisite_affiliate_profile_attribute_id">
    <div class="grid-elm grid-align-1-1 grid-offset">
        <!-- BEGIN showAffiliateId -->
        <div class="affiliate-profile-attribute-id" id="setAffiliateId">
            <div> <label>{TXT_CORE_MODULE_MULTISITE_AFFILIATE_PROFILE_ATTR_ID} : </label>{MULTISITE_AFFILIATE_PROFILE_ATTR_ID}</div>
       </div>
        <!-- END showAffiliateId -->
        <form id="affiliate-form" method="post">
        <!-- BEGIN showAffiliateIdForm -->
        <div id="setAffiliateId">
            <label>{TXT_CORE_MODULE_MULTISITE_CHOOSE_AFFILIATE_PROFILE_ATTR_ID} : </label>
                    <input type="text" name="affiliateProfileAttributeId" id="affiliateProfileAttributeId" style="width: 20%;" value="">
                    <div class="errorBlock"></div>
        </div>
        <!-- END showAffiliateIdForm -->
        <div id="paypal-mail">            
            <label style="width: 25%;">{TXT_CORE_MODULE_MULTISITE_PAYPAL_EMAIL_ADDRESS} : </label>
                <input type="email" id="paypalEmail" style="width: 20%;" name="paypalEmailAddress" value="{MULTISITE_PAYPAL_EMAIL_ADDRESS}">
                <div class="errorBlock"></div>
        </div>
        </form>
        <button style="margin-top: 0px;" type="submit" class="btn save loadingProcess" onclick="saveAffiliateIdAndPayPalMailAddress(jQuery(this))" data-loading-text="<img src='/lib/javascript/jquery/jstree/themes/default/throbber.gif' /> {TXT_CORE_MODULE_MULTISITE_LOADING_TEXT}">{TXT_CORE_MODULE_MULTISITE_SAVE}</button>
         
    </div>
</div>
<script type="text/javascript">
    /* <![CDATA[ */
    cx.ready(function(){
        //Disable the save button if no input given.
        if (   (   jQuery("#affiliateProfileAttributeId").length 
                && jQuery("#affiliateProfileAttributeId").val() === ''
               )
               || jQuery("#paypalEmail").val() === ''
            ) {
            jQuery(".save").prop('disabled', true);
        }
        
        jQuery.getScript(cx.variables.get('path', 'contrexx') + "core_modules/MultiSite/View/Script/CustomerPanel.js", function(){
           jQuery.getScript(cx.variables.get('path', 'contrexx') + "lib/javascript/jquery/bootstrapvalidator/js/bootstrapValidator.min.js", function() {
               jQuery("#affiliateProfileAttributeId").bind("input",function(){
                    this.value = this.value.toLowerCase();
                    if (this.value.length > 0) {
                        checkAvailablityOfAffiliateId(this.value);
                    } else {
                        hideErrorBlock(jQuery('#setAffiliateId .errorBlock'));
                        enableOrDisableButton();
                    }
                });
                jQuery("#paypalEmail").blur("change",function(){
                    var mailId  = this.value;
                    if ((mailId.length > 0) && !isValidEmail(mailId)) {
                        showErrorBlock(jQuery('#paypal-mail .errorBlock'), '{TXT_CORE_MODULE_MULTISITE_PAYPAL_EMAIL_ADDRESS_ERROR}');
                    } else {
                        hideErrorBlock(jQuery('#paypal-mail .errorBlock'));                        
                    }
                    enableOrDisableButton();
                });
           });            
       }); 
    });
   /* ]]> */
</script>

