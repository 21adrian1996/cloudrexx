<!-- BEGIN shop_import.html -->
<script language="JavaScript" type="text/javascript">
<!--
    function addPair() {
        var selectGiven = document.getElementById("given_field");
        var selectFile = document.getElementById("file_field");
        var selectLeft = document.getElementById("pairs_left");
        var selectRight = document.getElementById("pairs_right");
        if (selectGiven.selectedIndex >= 0 && selectFile.selectedIndex >= 0) {
            selectLeft[selectLeft.length] = new Option(selectFile[selectFile.selectedIndex].text,selectFile[selectFile.selectedIndex].value);
            selectRight[selectRight.length] = new Option(selectGiven[selectGiven.selectedIndex].text, selectGiven[selectGiven.selectedIndex].value);
        }
        resetHidden();
    }

    function removePair() {
        var selectGiven = document.getElementById("given_field");
        var selectFile = document.getElementById("file_field");
        var selectLeft = document.getElementById("pairs_left");
        var selectRight = document.getElementById("pairs_right");
        if (selectLeft.selectedIndex >= 0 || selectRight.selectedIndex >= 0) {
            selectLeft[selectLeft.selectedIndex] = null;
            selectRight[selectRight.selectedIndex] = null;
            selectLeft.selectedIndex = 0;
            selectRight.selectedIndex = 0;
        }
        resetHidden();
    }

    function removeCat() {
        var cats = document.getElementById("cats");
        if (cats.selectedIndex >= 0) {
            cats[cats.selectedIndex] = null;
            cats.selectedIndex = 0;
        }
        resetKat();
    }

    function addCat() {
        var selectFile = document.getElementById("file_field");
        var selectcats = document.getElementById("cats");

        if(selectFile.selectedIndex >= 0){
            selectcats[selectcats.length] =  new Option(selectFile[selectFile.selectedIndex].text,selectFile[selectFile.selectedIndex].value);
        }
        resetKat();
    }

    function resetKat() {
        var cats = document.getElementById("cats");
        var category = document.getElementById("category");

        var tmp = '';
        for (i = 0; i < cats.length; i++) {
            tmp += cats[i].value;
            tmp += ";";
        }
        category.value = tmp;
    }

    function resetHidden() {
        var selectLeft = document.getElementById("pairs_left");
        var selectRight = document.getElementById("pairs_right");
        var leftKeys = document.getElementById("pairs_left_keys");
        var rightKeys = document.getElementById("pairs_right_keys");

        var tmp = '';
        for (i = 0; i < selectLeft.length; i++) {
            tmp += selectLeft[i].value;
            tmp += ";";
        }
        leftKeys.value = tmp;

        tmp = '';
        for (i = 0; i < selectRight.length; i++) {
            tmp += selectRight[i].value;
            tmp += ";";
        }
        rightKeys.value = tmp;

    }

    function SaveImage() {
        if(document.getElementById("ImgName").value!=""){
            document.forms.frmSelectFields.submit();
        }else{
            alert("{TXT_SHOP_IMPORT_ENTER_TEMPLATE_NAME}");
        }
    }

    function MakeImport() {
        if(document.getElementById("importfile").value!=""){
            if(confirm("{TXT_SHOP_IMPORT_WARNING}")){
                document.forms.frmImportFile.submit();
            }
        }else{
            alert("{TXT_SHOP_IMPORT_SELECT_FILE_PLEASE}");
        }
    }

    function DeleteImg(ImgID) {
        if(confirm("{TXT_SHOP_IMPORT_TEMPLATE_REALLY_DELETE}")){
            document.location.href = '{SHOP_CMS_OFFSET}/admin/index.php?cmd=shop&act=import&deleteImg=exe&img='+ImgID;
        }
    }

    function MakeExport(groupCode) {
        if (confirm("{TXT_SHOP_EXPORT_WARNING}")) {
            document.location = "?cmd=shop&act=import&group="+groupCode;
        }
    }

{SHOP_EXPORT_TIPS}
Style[0]=["","","","","",,"black","#ffffe1","","","",,,,1,"#000000",2,24,0.3,,2,"gray",1,,15,-50];
// -->
</script>

<ul id="tabmenu">
    <li><a id="generalTab_import1" class="active" href="javascript:{}" onclick="selectTab('import1')" title="Import">{TXT_SHOP_IMPORT_IMPORT}</a></li>
    <li style="display: none;"><a id="generalTab_import2" class="active" href="javascript:{}" onclick="selectTab('import2')" title="Import">SelectFields</a></li>
    <li style="display: none;"><a id="generalTab_import3" class="active" href="javascript:{}" onclick="selectTab('import3')" title="Import">Upload</a></li>
    <li><a id="generalTab_import4" href="javascript:{}" onclick="selectTab('import4')" title="Image">{TXT_SHOP_IMPORT_MANAGE_TEMPLATES}</a></li>
    <li><a id="generalTab_export" href="javascript:{}" onclick="selectTab('export')" title="Export">{TXT_SHOP_EXPORT_DATA}</a></li>
</ul>

<form name="frmImportFile" action="{SHOP_CMS_OFFSET}/admin/index.php?cmd=shop&amp;act=import" method="post" enctype="multipart/form-data">
<input type="hidden" name="exe" value="ImportFile" />
<div id="import1" class="generalTab" style="display:{SELECTED_LAYER_IMPORT}">
    <table border="0" cellspacing="0" cellpadding="2" width=100% class="adminlist">
        <tr>
            <th colspan="2"><b>{TXT_SHOP_IMPORT_TITLE}</b></th>
        </tr>
    </table>
    <div id="ImportLayer" style="display: block;">
    <table border="0" cellspacing="0" cellpadding="2" width=100% class="adminlist">
        <tr class="row1">
            <td nowrap="nowrap">&nbsp;{TXT_SHOP_IMPORT_SELECT_TEMPLATE}:</td>
            <td  nowrap="nowrap" width="100%">
                {IMAGE_CHOICE}
            </td>
        </tr>
        <tr class="row2">
            <td nowrap="nowrap">&nbsp;{TXT_SHOP_IMPORT_FILE}:</td>
            <td  nowrap="nowrap"><input type="file" name="importfile" id="importfile" style="width: 200px;" size="50" /></td>
        </tr>
    </table>
    <br />
    <input type="button" value="{TXT_SHOP_IMPORT_IMPORT}" onclick="MakeImport();" {IMPORT_BUTTON_STYLE} />
    </div>
    <br />
    {TXT_SHOP_IMPORT_CHOOSE_TEMPLATE_TIPS}
</div>
</form>

<!-- Begin FieldsSelect -->
<form name="frmSelectFields" action="{SHOP_CMS_OFFSET}/admin/index.php?cmd=shop&amp;act=import" method="post">
<input type="hidden" name="exe" value="SaveImg" />
<input type="hidden" name="pairs_left_keys" id="pairs_left_keys" value="" />
<input type="hidden" name="pairs_right_keys" id="pairs_right_keys" value="" />
<input type="hidden" name="category" id="category" value="" />
<div id="import2" class="generalTab" style="display:{SELECTED_LAYER_IMG}">
    <table border="0" cellspacing="0" cellpadding="2" width=100% class="adminlist">
        <tr>
            <th colspan="4"><b>{TXT_SHOP_IMPORT_IMPORTTEMPLATE}</b></th>
        </tr>
        <tr class="row2">
            <td valign="top">
                <b>{TXT_SHOP_IMPORT_TEXTFILE}:</b><br />
                {FILE_FIELDS_LIST}
            </td>
            <td>&nbsp;&nbsp;</td>
            <td valign="top">
                <b>{TXT_SHOP_IMPORT_DATABASE}:</b><br />
                {DB_FIELDS_LIST}
            </td>
            <td width="50%">
                {TXT_SHOP_IMPORT_ASSIGNMENT_TIPS}<br /><br />
                {TXT_SHOP_IMPORT_CATEGORY_TIPS}
            </td>
        </tr>
        <tr class="row1">
            <td colspan="4">
                <input type="button" value="{TXT_SHOP_IMPORT_ADD_FEW}" onclick="addPair();" />&nbsp;&nbsp;<input type="button" value="{TXT_SHOP_IMPORT_ADD_CATEGORY}" onclick="addCat();" />
            </td>
        </tr>
        <tr class="row2">
            <td colspan="3">
                <b>{TXT_SHOP_IMPORT_CATEGORIES}:</b><br />
                <select name="cats" id="cats" style="width: 200px;" size="5"></select>
            </td>
            <td>
                {TXT_SHOP_IMPORT_CATEGORY_REMOVE_TIPS}
            </td>
        </tr>
        <tr class="row1">
            <td colspan="4">
                <input type="button" value="{TXT_SHOP_IMPORT_REMOVE_CATEGORY}" onclick="removeCat();" />
            </td>
        </tr>
        <tr class="row2">
            <td valign="top">
                <select name="fileList" id="pairs_left" style="width: 200px;" size="10" onchange="document.getElementById('pairs_right')[this.selectedIndex].selected=true"></select>
            </td>
            <td>&nbsp;&nbsp;</td>
            <td valign="top">
                <select name="DbList" id="pairs_right" style="width: 200px;" size="10" onchange="document.getElementById('pairs_left')[this.selectedIndex].selected=true"></select>
            </td>
            <td>
                {TXT_SHOP_IMPORT_ASSIGNMENT_REMOVE_TIPS}
            </td>
        </tr>
        <tr class="row1">
            <td colspan="4">
                <input type="button" value="{TXT_SHOP_IMPORT_REMOVE_FEW}" onclick="removePair();" />
            </td>
        </tr>
        <tr class="row2">
            <td colspan="3">
                <b>{TXT_SHOP_IMPORT_TEMPLATENAME}:</b> <input type="text" name="ImgName" id="ImgName" />
            </td>
            <td>
                {TXT_SHOP_IMPORT_TEMPLATE_SAVE_TIPS}
            </td>
        </tr>
    </table>
    <br />
    <input type="button" value="{TXT_SHOP_IMPORT_SAVE}" onclick="SaveImage();" />
</div>
</form>
<!-- End FieldsSelect -->

<div id="import4" class="generalTab" style="display: none;">
    <table border="0" cellspacing="0" cellpadding="2" width=100% class="adminlist">
        <tr>
            <th colspan="2"><b>{TXT_SHOP_IMPORT_SAVED_TEMPLATES}</b></th>
        </tr>
        <tr>
            <td><b>{TXT_SHOP_IMPORT_TEMPLATENAME}</b></td>
            <td width="8%"><div style="text-align:right;"><b>{TXT_FUNCTIONS}</b></div></td>
        </tr>
        <!-- BEGIN imgRow -->
        <tr class="{CLASS_NAME}">
            <td>{IMG_NAME}</td>
            <td><div style="text-align:right;"><a href="javascript:DeleteImg({IMG_ID});"><img src="{SHOP_CMS_OFFSET}/admin/images/icons/delete.gif" border="0" alt="{TXT_DELETE}" title="{TXT_DELETE}" /></a></div></td>
        </tr>
        <!-- END imgRow -->
    </table>
    <br />
    <form name="frmUpload" enctype="multipart/form-data" action="{SHOP_CMS_OFFSET}/admin/index.php?cmd=shop&amp;act=import" method="post">
    <input type="hidden" name="cmd" value="shop" />
    <input type="hidden" name="act" value="import" />
    <input type="hidden" name="mode" value="ImportImg" />
    <input type="hidden" name="exe" value="SelectFields" />
    <table border="0" cellspacing="0" cellpadding="2" width=100% class="adminlist">
        <tr>
            <th><b>{TXT_SHOP_IMPORT_MAKE_NEW_TEMPLATE}</b></th>
        </tr>
        <tr class="row1">
            <td>&nbsp;<input type="file" name="CSVfile" size="50" /></td>
        </tr>
    </table>
    <br />
    &nbsp;<input type="submit" value="{TXT_SHOP_IMPORT_UPLOAD}" />
    </form>
    <br />
    {TXT_SHOP_IMPORT_CREATE_TEMPLATE_TIPS}
</div>

<div id="import3" class="generalTab" style="display: none;">
    <i>{TXT_SHOP_IMPORT_NO_TEMPLATES_AVAILABLE}</i>
</div>

<div id="export" class="generalTab" style="display: none;">
    <table border="0" cellspacing="0" cellpadding="2" width=100% class="adminlist">
    <colgroup><col width='10%'/><col width='10%'/><col width='80%'/></colgroup>
        <tr>
            <th nowrap='nowrap' colspan="3"><b>{TXT_SHOP_EXPORT}</b></th>
        </tr>
        <tr class="row1">
            <td nowrap='nowrap' valign="top" colspan="3">
                <b>{TXT_SHOP_EXPORT_SELECTION}</b><br />
            </td>
        </tr>
<!-- BEGIN groupRow -->
        <tr class="{CLASS_NAME}">
            <td nowrap='nowrap'>
                <span class="info" onmouseout="htm()" onmouseover="stm(Text[{SHOP_EXPORT_INDEX}],Style[0])">
                    {SHOP_EXPORT_GROUP}
                </span>
            </td>
            <td colspan="2">
                <a href="#" title="{TXT_EXPORT}" onclick="javascript:MakeExport('{SHOP_EXPORT_GROUP_CODE}');" >
                    <img src="/images/modules/shop/csv.gif" alt="{TXT_EXPORT}" border="0" />
                </a>
            </td>
        </tr>
<!-- END groupRow -->
    </table>
    <br />
    {TXT_SHOP_EXPORT_TIPS}
</div>

<script language="javascript" type="text/javascript">
<!-- //
{SELECT_LAYER_ONLOAD}
{NO_FILES}
// -->
</script>

<!-- END shop_import.html -->
