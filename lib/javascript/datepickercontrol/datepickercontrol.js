DatePickerControl.createButton=function(I,B){var D=this.buttonIdPrefix+I.id;if(document.getElementById(D)){return false}var E="";if(B){var G=I.id.split("_");var J=G[G.length-1];if((J.indexOf("-")>0||J.indexOf("/")>0||J.indexOf(".")>0)&&J.indexOf("YY")>=0&&J.indexOf("D")>=0&&J.indexOf("M")>=0){E=J}else{E=this.defaultFormat}}else{E=I.getAttribute("datepicker_format");if(!E){E=this.defaultFormat}}I.setAttribute("datepicker_format",E);I.setAttribute("maxlength",E.length);I.setMinDate=function(K){this.setAttribute("datepicker_min",K)};I.setMaxDate=function(K){this.setAttribute("datepicker_max",K)};var F=document.createElement("div");F.id=D;F.title=this.buttonTitle;F.setAttribute("datepicker_inputid",I.id);F.setAttribute("datepicker_format",E);if(F.addEventListener){F.addEventListener("click",DPC_onButtonClick,false)}else{if(F.attachEvent){F.attachEvent("onclick",DPC_onButtonClick)}}if(I.parentNode){I.parentNode.appendChild(F)}else{document.body.appendChild(F)}var C=getObject.getSize("offsetTop",I);var A=getObject.getSize("offsetLeft",I);if(I.id=="DPC_popupFrom_YYYY-MM-DD"||I.id=="DPC_popupTo_YYYY-MM-DD"){F.className="none"}else{F.className="calendarbutton"}F.style.zIndex=10000;F.style.cursor="pointer";F.style.top=(C+Math.floor((I.offsetHeight-F.offsetHeight)/2)+this.buttonOffsetY)+"px";var H=Math.floor((I.offsetHeight-F.offsetHeight)/2);if(this.buttonPosition=="in"){F.style.left=(A+I.offsetWidth-F.offsetWidth-H+this.buttonOffsetX)+"px"}else{F.style.left=(A+I.offsetWidth+H+this.buttonOffsetX)+"px"}return true};DatePickerControl.defaultFormat="YYYY-MM-DD";DatePickerControl.submitFormat="";DatePickerControl.offsetY=1;DatePickerControl.offsetX=0;DatePickerControl.todayText="Heute";DatePickerControl.buttonTitle="Kalender";DatePickerControl.buttonPosition="in";DatePickerControl.buttonOffsetX=0;DatePickerControl.buttonOffsetY=0;DatePickerControl.closeOnTodayBtn=true;DatePickerControl.defaultTodaySel=true;DatePickerControl.autoShow=true;DatePickerControl.firstWeekDay=1;DatePickerControl.weekend=[0,6];DatePickerControl.weekNumber=false;DatePickerControl.Months=["Januar","Februar","M&auml;rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];DatePickerControl.Days=["Son","Mon","Die","Mit","Don","Fre","Sam"];DatePickerControl.useTrickyBG=false;if(navigator.userAgent.indexOf("MSIE")>1){DatePickerControl.useTrickyBG=true;DatePickerControl.offsetY=0;DatePickerControl.offsetX=-1;DatePickerControl.buttonOffsetX=-4;DatePickerControl.buttonOffsetY=-2;if(document.getElementsByTagName("html")[0].getAttribute("xmlns")!=null){DatePickerControl.offsetY=18;DatePickerControl.offsetX=10;DatePickerControl.buttonOffsetX=0;DatePickerControl.buttonOffsetY=-1}}DatePickerControl.editIdPrefix="DPC_";DatePickerControl.displayed=false;DatePickerControl.HIDE_TIMEOUT=200;DatePickerControl.hideTimeout=null;DatePickerControl.buttonIdPrefix="CALBUTTON";DatePickerControl.dayIdPrefix="CALDAY";DatePickerControl.currentDay=1;DatePickerControl.originalValue="";DatePickerControl.calFrameId="calendarframe";DatePickerControl.submitByKey=false;DatePickerControl.dayOfWeek=0;DatePickerControl.firstFocused=false;DatePickerControl.hideCauseBlur=false;DatePickerControl.onSubmitAsigned=false;DatePickerControl.minDate=null;DatePickerControl.maxDate=null;DatePickerControl.DOMonth=[31,28,31,30,31,30,31,31,30,31,30,31];DatePickerControl.lDOMonth=[31,29,31,30,31,30,31,31,30,31,30,31];function DatePickerControl(){}DatePickerControl.init=function(){if(!document.getElementById("CalendarPickerControl")){this.setGlobalParams();this.calBG=null;if(this.useTrickyBG){this.calBG=document.createElement("iframe");this.calBG.id="CalendarPickerControlBG";this.calBG.style.zIndex="49999";this.calBG.style.position="absolute";this.calBG.style.display="none";this.calBG.style.border="0px solid transparent";document.body.appendChild(this.calBG)}this.calContainer=document.createElement("div");this.calContainer.id="CalendarPickerControl";this.calContainer.style.zIndex="50000";this.calContainer.style.position="absolute";this.calContainer.style.display="none";document.body.appendChild(this.calContainer);if(this.calContainer.addEventListener){this.calContainer.addEventListener("click",DPC_onContainerClick,false);window.addEventListener("resize",DPC_onWindowResize,false)}else{if(this.calContainer.attachEvent){this.calContainer.attachEvent("onclick",DPC_onContainerClick);window.attachEvent("onresize",DPC_onWindowResize)}}}var A=document.getElementsByTagName("input");var D=A.length;for(i=0;i<D;i++){if(A[i].type.toLowerCase()=="text"){var E=A[i];var C=E.getAttribute("datepicker");var B=false;if(C!=null&&C=="true"){if(E.id){if(!this.createButton(E,false)){continue}B=true}else{alert("Attribute 'id' is mandatory for DatePickerControl.")}}else{if(E.id&&E.id.indexOf(this.editIdPrefix)==0){if(!this.createButton(E,true)){continue}B=true}}E.setAttribute("isdatepicker","true");if(B){if(E.addEventListener){E.addEventListener("keyup",DPC_onEditControlKeyUp,false);E.addEventListener("keydown",DPC_onEditControlKeyDown,false);E.addEventListener("keypress",DPC_onEditControlKeyPress,false);E.addEventListener("blur",DPC_onEditControlBlur,false);E.addEventListener("focus",DPC_onEditControlFocus,false);E.addEventListener("change",DPC_onEditControlChange,false)}else{if(E.attachEvent){E.attachEvent("onkeyup",DPC_onEditControlKeyUp);E.attachEvent("onkeydown",DPC_onEditControlKeyDown);E.attachEvent("onkeypress",DPC_onEditControlKeyPress);E.attachEvent("onblur",DPC_onEditControlBlur);E.attachEvent("onfocus",DPC_onEditControlFocus);E.attachEvent("onchange",DPC_onEditControlChange)}}var F=E.form;if(!this.onSubmitAsigned&&F){this.onSubmitAsigned=true;F.submitOrig=F.submit;F.submit=DPC_formSubmit;if(F.addEventListener){F.addEventListener("submit",DPC_onFormSubmit,false)}else{if(F.attachEvent){F.attachEvent("onsubmit",DPC_onFormSubmit)}}}}}}};DatePickerControl.setGlobalParams=function(){var obj=document.getElementById("DPC_DEFAULT_FORMAT");if(obj){this.defaultFormat=obj.value}obj=document.getElementById("DPC_SUBMIT_FORMAT");if(obj){this.submitFormat=obj.value}obj=document.getElementById("DPC_FIRST_WEEK_DAY");if(obj){this.firstWeekDay=(obj.value<0||obj.value>6)?0:parseInt(obj.value)}obj=document.getElementById("DPC_WEEKEND_DAYS");if(obj){eval("this.weekend = "+obj.value)}obj=document.getElementById("DPC_AUTO_SHOW");if(obj){this.autoShow=obj.value=="true"}obj=document.getElementById("DPC_DEFAULT_TODAY");if(obj){this.defaultTodaySel=obj.value=="true"}obj=document.getElementById("DPC_CALENDAR_OFFSET_X");if(obj){this.offsetX=parseInt(obj.value)}obj=document.getElementById("DPC_CALENDAR_OFFSET_Y");if(obj){this.offsetY=parseInt(obj.value)}obj=document.getElementById("DPC_TODAY_TEXT");if(obj){this.todayText=obj.value}obj=document.getElementById("DPC_BUTTON_TITLE");if(obj){this.buttonTitle=obj.value}obj=document.getElementById("DPC_BUTTON_POSITION");if(obj){this.buttonPosition=obj.value}obj=document.getElementById("DPC_BUTTON_OFFSET_X");if(obj){this.buttonOffsetX=parseInt(obj.value)}obj=document.getElementById("DPC_BUTTON_OFFSET_Y");if(obj){this.buttonOffsetY=parseInt(obj.value)}obj=document.getElementById("DPC_WEEK_NUMBER");if(obj){this.weekNumber=obj.value=="true"}obj=document.getElementById("DPC_MONTH_NAMES");if(obj){eval("this.Months = "+obj.value)}obj=document.getElementById("DPC_DAY_NAMES");if(obj){eval("this.Days = "+obj.value)}};function DPC_autoInit(){DatePickerControl.init()}if(window.addEventListener){window.addEventListener("load",DPC_autoInit,false)}else{if(window.attachEvent){window.attachEvent("onload",DPC_autoInit)}}DatePickerControl.show=function(){if(!this.displayed){var A=this.inputControl;if(A==null){return }if(A.disabled){return }var D=getObject.getSize("offsetTop",A);var C=getObject.getSize("offsetLeft",A);var B=document.getElementById(this.calFrameId);this.calContainer.style.top=D+A.offsetHeight+this.offsetY+"px";this.calContainer.style.left=C+this.offsetX+"px";this.calContainer.style.display="none";this.calContainer.style.visibility="visible";
this.calContainer.style.display="block";this.calContainer.style.height=B.offsetHeight;if(this.calBG){this.calBG.style.top=this.calContainer.style.top;this.calBG.style.left=this.calContainer.style.left;this.calBG.style.display="none";this.calBG.style.visibility="visible";this.calBG.style.display="block";this.calBG.style.width=this.calContainer.offsetWidth;if(B){this.calBG.style.height=B.offsetHeight}}this.displayed=true;A.focus()}};DatePickerControl.hide=function(){if(this.displayed){this.calContainer.style.visibility="hidden";this.calContainer.style.left=-1000;this.calContainer.style.top=-1000;if(this.calBG){this.calBG.style.visibility="hidden";this.calBG.style.left=-1000;this.calBG.style.top=-1000}this.inputControl.value=this.originalValue;this.displayed=false}};DatePickerControl.getMonthName=function(A){return this.Months[A]};DatePickerControl.getDaysOfMonth=function(B,A){if(this.isLeapYear(A)){return this.lDOMonth[B]}else{return this.DOMonth[B]}};DatePickerControl.calcMonthYear=function(B,A,D){var C=new Array();if(D==-1){if(B==0){C[0]=11;C[1]=parseInt(A)-1}else{C[0]=parseInt(B)-1;C[1]=parseInt(A)}}else{if(D==1){if(B==11){C[0]=0;C[1]=parseInt(A)+1}else{C[0]=parseInt(B)+1;C[1]=parseInt(A)}}}return C};DatePickerControl.getAllCode=function(){var A="";A+="<table class='calframe' id='"+this.calFrameId+"'>";A+=this.getHeaderCode();A+=this.getDaysHeaderCode();A+=this.getDaysCode();A+="</table>";return A};DatePickerControl.getHeaderCode=function(){var D=this.calcMonthYear(this.month,this.year,-1);var G=D[0];var I=D[1];var F=this.calcMonthYear(this.month,this.year,1);var H=F[0];var A=F[1];var C=new Date();var B="";var E=this.weekNumber?8:7;B+="<tr><td colspan='"+E+"' class='monthname'>";B+=this.monthName+"&nbsp;&nbsp;";B+="<span title='"+this.Months[this.month]+" "+(parseInt(this.year)-1)+"' class='yearbutton' ";B+="onclick='DatePickerControl.build("+this.month+", "+(parseInt(this.year)-1)+");return false;'>&laquo;</span>";B+="&nbsp;"+this.year+"&nbsp;";B+="<span title='"+this.Months[this.month]+" "+(parseInt(this.year)+1)+"' class='yearbutton' ";B+="onclick='DatePickerControl.build("+this.month+", "+(parseInt(this.year)+1)+");return false;'>&raquo;</span>";B+="</td></tr>";B+="<tr><td style='border-width:0px' colspan='"+E+"'>";B+="<table class='navigation' width='100%'><tr>";B+="<td class='navbutton' title='"+this.Months[G]+" "+I+"' ";B+="onclick='DatePickerControl.build("+G+", "+I+");return false;'>&lt;&lt;</td>";B+="<td class='navbutton' title='"+C.getDate()+" "+this.Months[C.getMonth()]+" "+C.getFullYear()+"' ";B+="onclick='DatePickerControl.build("+C.getMonth()+", "+C.getFullYear()+");DatePickerControl.selectToday();return false;'>";B+=this.todayText+"</td>";B+="<td class='navbutton' title='"+this.Months[H]+" "+A+"' ";B+="onclick='DatePickerControl.build("+H+", "+A+");return false;'>&gt;&gt;</td>";B+="</tr></table>";B+="</td></tr>";return B};DatePickerControl.getDaysHeaderCode=function(){var A="";A=A+"<tr>";if(this.weekNumber){A+="<td class='weeknumber'>&nbsp;</td>"}for(i=this.firstWeekDay;i<this.firstWeekDay+7;i++){A+="<td class='dayname' width='14%'>"+this.Days[i%7]+"</td>"}A=A+"</tr>";return A};DatePickerControl.getDaysCode=function(){var F=new Date();F.setDate(1);F.setMonth(this.month);F.setFullYear(this.year);var H=F.getDay();var I=1;var D=this.getDaysOfMonth(this.month,this.year);var E=0;var C="";this.dayOfWeek=H;var G=this.month==0?11:this.month-1;var B=this.prevm==11?this.year-1:this.year;prevmontdays=this.getDaysOfMonth(G,B);H=(H==0&&this.firstWeekDay)?7:H;if(this.weekNumber){var A=this.getWeekNumber(this.year,this.month,1)}C+="<tr>";if(this.weekNumber){C+="<td class='weeknumber'>"+A+"</td>"}for(i=this.firstWeekDay;i<H;i++){C=C+"<td class='dayothermonth'>"+(prevmontdays-H+i+1)+"</td>"}for(j=H-this.firstWeekDay;j<7;j++){if(this.isInRange(I)){classname=this.getDayClass(I,j);C+="<td class='"+classname+"' class_orig='"+classname+"' onClick='DatePickerControl.writeDate("+I+")' id='"+this.dayIdPrefix+I+"'>"+I+"</td>"}else{C+="<td class='dayothermonth'>"+I+"</td>"}I++}C=C+"</tr>";for(k=2;k<7;k++){C=C+"<tr>";if(this.weekNumber){A++;if(A>=53){A=1}C+="<td class='weeknumber'>"+A+"</td>"}for(j=0;j<7;j++){if(this.isInRange(I)){classname=this.getDayClass(I,j);C+="<td class='"+classname+"' class_orig='"+classname+"' onClick='DatePickerControl.writeDate("+I+")' id='"+this.dayIdPrefix+I+"'>"+I+"</td>"}else{C+="<td class='dayothermonth'>"+I+"</td>"}I++;if(I>D){E=1;break}}if(j==6){C+="</tr>"}if(E==1){break}}for(m=1;m<(7-j);m++){C+="<td class='dayothermonth'>"+m+"</td>"}return C};DatePickerControl.getDayClass=function(A,F){var G=new Date();var D=G.getDate();var C=G.getMonth();var B=G.getFullYear();if(A==D&&this.month==C&&this.year==B){return"today"}else{var E=(7+F+this.firstWeekDay)%7;for(i=0;i<this.weekend.length;i++){if(E==this.weekend[i]){return"weekend"}}return"day"}};DatePickerControl.formatData=function(C){var G;var F=1+this.month;F=(F.toString().length<2)?"0"+F:F;var H=this.getMonthName(this.month).substr(0,3).toUpperCase();var B=this.getMonthName(this.month).toUpperCase();var D=new String(this.year);var E=new String(this.year).substr(2,2);var A=(C.toString().length<2)?"0"+C:C;switch(this.format){case"MM/DD/YYYY":G=F+"/"+A+"/"+D;break;case"MM/DD/YY":G=F+"/"+A+"/"+E;break;case"MM-DD-YYYY":G=F+"-"+A+"-"+D;break;case"MM-DD-YY":G=F+"-"+A+"-"+E;break;case"YYYY-MM-DD":G=D+"-"+F+"-"+A;break;case"YYYY/MM/DD":G=D+"/"+F+"/"+A;break;case"DD/MON/YYYY":G=A+"/"+H+"/"+D;break;case"DD/MON/YY":G=A+"/"+H+"/"+E;break;case"DD-MON-YYYY":G=A+"-"+H+"-"+D;break;case"DD-MON-YY":G=A+"-"+H+"-"+E;break;case"DD/MONTH/YYYY":G=A+"/"+B+"/"+D;break;case"DD/MONTH/YY":G=A+"/"+B+"/"+E;break;case"DD-MONTH-YYYY":G=A+"-"+B+"-"+D;break;case"DD-MONTH-YY":G=A+"-"+B+"-"+E;break;case"DD/MM/YYYY":G=A+"/"+F+"/"+D;break;case"DD/MM/YY":G=A+"/"+F+"/"+E;break;case"DD-MM-YYYY":G=A+"-"+F+"-"+D;break;case"DD-MM-YY":G=A+"-"+F+"-"+E;break;case"DD.MM.YYYY":G=A+"."+F+"."+D;break;case"DD.MM.YY":G=A+"."+F+"."+E;break;default:G=F+"/"+A+"/"+D}return G};DatePickerControl.getDateFromControl=function(B){if(B==null){B=this.inputControl}var A=B.value;var C=B.getAttribute("datepicker_format");return this.getDateFromString(A,C.toString())};DatePickerControl.getDateFromString=function(F,E){var G=new Date();var A,D,B;if(F==""||E==""){return G}F=F.replace("/","@").replace("/","@");F=F.replace("-","@").replace("-","@");F=F.replace(".","@").replace(".","@");if(F.indexOf("/")>=0||F.indexOf("-")>=0||F.indexOf(".")>=0){return G}var C=F.split("@");if(C.length!=3){return G}for(i=0;i<3;i++){C[i]=parseFloat(C[i]);if(isNaN(C[i])){return G}}if(E.substring(0,1).toUpperCase()=="D"){G.setDate(C[0]);G.setMonth(C[1]-1);G.setFullYear(this.yearTwo2Four(C[2]))}else{if(E.substring(0,1).toUpperCase()=="Y"){G.setDate(C[2]);G.setMonth(C[1]-1);G.setFullYear(this.yearTwo2Four(C[0]))}else{if(E.substring(0,1).toUpperCase()=="M"){G.setDate(C[1]);G.setMonth(C[0]-1);G.setFullYear(this.yearTwo2Four(C[2]))}}}return G};DatePickerControl.yearTwo2Four=function(A){if(A<99){if(A>=30){A+=1900}else{A+=2000}}return A};DatePickerControl.writeDate=function(A){var B=this.formatData(A);this.inputControl.value=B;this.originalValue=B;this.hide();if(DatePickerControl.onSelect){DatePickerControl.onSelect(this.inputControl.id)}this.firstFocused=true;this.inputControl.focus()};DatePickerControl.writeCurrentDate=function(){var A=this.formatData(this.currentDay);this.inputControl.value=A};DatePickerControl.build=function(A,G){var F=this.month;var E=this.year;var D=document.getElementById(this.calFrameId);if(A==null){var B=new Date();this.month=B.getMonth();this.year=B.getFullYear()}else{this.month=A;this.year=G}if(!this.isInRange(null)){this.month=F;this.year=E}if(!this.isInRange(this.currentDay)){if(this.minDate&&this.currentDay<this.minDate.getDate()){this.currentDay=this.minDate.getDate()}if(this.maxDate&&this.currentDay>this.maxDate.getDate()){this.currentDay=this.maxDate.getDate()}}this.monthName=this.Months[this.month];var C=this.getAllCode();writeLayer(this.calContainer.id,null,C);
if(this.calContainer&&D){this.calContainer.style.height=D.offsetHeight}this.firstFocused=true;this.inputControl.focus();this.selectDay(this.currentDay)};DatePickerControl.buildPrev=function(){if(!this.displayed){return }var B=this.calcMonthYear(this.month,this.year,-1);var C=B[0];var A=B[1];this.build(C,A)};DatePickerControl.buildNext=function(){if(!this.displayed){return }var B=this.calcMonthYear(this.month,this.year,1);var C=B[0];var A=B[1];this.build(C,A)};DatePickerControl.selectToday=function(){var B=new Date();var A=B.getDate();if(!this.isInRange(A)){return }if(this.closeOnTodayBtn){this.currentDay=A;this.writeDate(this.currentDay)}else{this.selectDay(A)}};DatePickerControl.selectDay=function(C){if(!this.displayed){return }if(!this.isInRange(C)){return }var E=this.currentDay;var A=this.getDaysOfMonth(this.month,this.year);if(C>A){return }var B=document.getElementById(this.dayIdPrefix+C);var D=document.getElementById(this.dayIdPrefix+this.currentDay);if(D){D.className=D.getAttribute("class_orig")}if(B){B.className="current";this.currentDay=C;this.writeCurrentDate()}};DatePickerControl.selectPrevDay=function(C){if(!this.displayed){return }var D=this.currentDay;var A=this.getDaysOfMonth(this.month,this.year);var B=D-C;if(B<=0){if(C==7){D=(D+this.dayOfWeek)+28-this.dayOfWeek;D--;B=D>A?D-7:D}else{B=A}}this.selectDay(B)};DatePickerControl.selectNextDay=function(D){if(!this.displayed){return }var C=this.currentDay;var A=this.getDaysOfMonth(this.month,this.year);var B=C+D;if(B>A){if(D==7){C=((C+this.dayOfWeek)%7)-this.dayOfWeek;B=C<0?C+7:C;B++}else{B=1}}this.selectDay(B)};DatePickerControl.showForEdit=function(B){if(this.displayed){return }if(B==null){return }if(B.disabled){return }this.inputControl=B;this.originalValue=B.value;var D=this.inputControl.getAttribute("datepicker_format");if(D==null){D=this.defaultFormat}this.format=D;if(this.validate(B.value,D)){var A=this.getDateFromControl();this.currentDate=A;this.build(A.getMonth(),A.getFullYear());this.currentDay=A.getDate()}else{B.value="";this.originalValue="";this.currentDate=null;if(this.defaultTodaySel){this.currentDay=new Date().getDate()}else{this.currentDay=1}this.build(null,null)}var C=document.getElementById(this.dayIdPrefix+this.currentDay);if(C){C.className="current"}this.writeCurrentDate();this.show()};DatePickerControl.isInRange=function(B){if(!this.minDate&&!this.maxDate){return true}if(B){var F=new Date();F.setFullYear(this.year);F.setMonth(this.month);F.setDate(B);if(this.minDate){if(this.compareDates(F,this.minDate)<0){return false}}if(this.maxDate){if(this.compareDates(F,this.maxDate)>0){return false}}}else{var E=parseInt(this.year.toString()+(this.month<10?"0"+this.month.toString():this.month.toString()));var A;if(this.minDate){A=this.minDate.getMonth();var D=parseInt(this.minDate.getFullYear().toString()+(A<10?"0"+A.toString():A.toString()));if(E<D){return false}}if(this.maxDate){A=this.maxDate.getMonth();var C=parseInt(this.maxDate.getFullYear().toString()+(A<10?"0"+A.toString():A.toString()));if(E>C){return false}}}return true};DatePickerControl.compareDates=function(G,F){var A=G.getMonth();var H=G.getDate();var D=G.getFullYear().toString()+(A<10?"0"+A.toString():A.toString())+(H<10?"0"+H.toString():H.toString());A=F.getMonth();H=F.getDate();var B=F.getFullYear().toString()+(A<10?"0"+A.toString():A.toString())+(H<10?"0"+H.toString():H.toString());var E=parseInt(D);var C=parseInt(B);return E-C};DatePickerControl.validate=function(E,K){var L;var F;var I,D,J;var A=this.currentDay,H=this.month,B=this.year;if(E==""){return false}if(K.substring(0,1).toUpperCase()=="D"){L=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{2,4}$/}else{if(K.substring(0,1).toUpperCase()=="Y"){L=/^\d{2,4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/}else{if(K.substring(0,1).toUpperCase()=="M"){L=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{2,4}$/}}}if(!L.test(E)){return false}F=(E.indexOf("/")>1)?"/":((E.indexOf("-")>1)?"-":".");var C=E.split(F);if(K.substring(0,1).toUpperCase()=="D"){I=parseFloat(C[0]);D=parseFloat(C[1]);J=parseFloat(C[2])}else{if(K.substring(0,1).toUpperCase()=="Y"){I=parseFloat(C[2]);D=parseFloat(C[1]);J=parseFloat(C[0])}else{if(K.substring(0,1).toUpperCase()=="M"){I=parseFloat(C[1]);D=parseFloat(C[0]);J=parseFloat(C[2])}}}if(D<1||D>12){return false}if(I>this.getDaysOfMonth(D-1)){return false}this.month=D;this.year=J;var G=this.isInRange(I);this.month=H;this.year=B;return G};DatePickerControl.isLeapYear=function(A){if((A%4)==0){if((A%100)==0&&(A%400)!=0){return false}return true}return false};function DPC_onButtonClick(A){DatePickerControl.onButtonClick(A)}DatePickerControl.onButtonClick=function(C){if(!this.displayed){if(C==null){C=window.event}var B=(C.srcElement)?C.srcElement:C.originalTarget;var A=document.getElementById(B.getAttribute("datepicker_inputid"));this.showForEdit(A)}else{this.hide()}};function DPC_onContainerClick(A){DatePickerControl.onContainerClick(A)}DatePickerControl.onContainerClick=function(A){if(A==null){A=window.event}if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}this.inputControl.focus();return false};function DPC_onEditControlKeyUp(A){DatePickerControl.onEditControlKeyUp(A)}DatePickerControl.onEditControlKeyUp=function(C){if(C==null){C=window.event}var B=C.srcElement?C.srcElement:C.originalTarget;var A=C.charCode?C.charCode:C.which?C.which:C.keyCode;switch(A){case 37:this.selectPrevDay(1);break;case 38:this.selectPrevDay(7);break;case 39:this.selectNextDay(1);break;case 40:if(!this.displayed){this.showForEdit(B)}else{this.selectNextDay(7);break}break;case 27:this.hide();break;case 33:if((C.modifiers&Event.SHIFT_MASK)||(C.shiftKey)){this.build(this.month,parseInt(this.year)-1)}else{this.buildPrev()}break;case 34:if((C.modifiers&Event.SHIFT_MASK)||(C.shiftKey)){this.build(this.month,parseInt(this.year)+1)}else{this.buildNext()}break;case 13:if(this.displayed&&this.currentDay>0&&this.submitByKey){this.writeDate(this.currentDay)}break}return false};function DPC_onEditControlKeyDown(A){DatePickerControl.onEditControlKeyDown(A)}DatePickerControl.onEditControlKeyDown=function(C){if(C==null){C=window.event}var B=C.srcElement?C.srcElement:C.originalTarget;var A=C.charCode?C.charCode:C.which?C.which:C.keyCode;if(A>=65&&A<=90){if(C.stopPropagation){C.stopPropagation()}if(C.preventDefault){C.preventDefault()}C.returnValue=false;C.cancelBubble=true;return false}switch(A){case 13:this.submitByKey=true;break;case 9:case 32:if(this.displayed&&this.currentDay>0){this.writeDate(this.currentDay)}break}};function DPC_onEditControlKeyPress(A){DatePickerControl.onEditControlKeyPress(A)}DatePickerControl.onEditControlKeyPress=function(C){if(C==null){C=window.event}var B=C.srcElement?C.srcElement:C.originalTarget;var A=C.charCode?C.charCode:C.which?C.which:C.keyCode;if(!((A<32)||(A>44&&A<58))){if(C.stopPropagation){C.stopPropagation()}if(C.preventDefault){C.preventDefault()}C.returnValue=false;C.cancelBubble=true;return false}};function DPC_onEditControlBlur(A){DatePickerControl.onEditControlBlur(A)}DatePickerControl.onEditControlBlur=function(A){if(A==null){A=window.event}if(!this.hideTimeout){this.hideTimeout=setTimeout("DatePickerControl.hide()",this.HIDE_TIMEOUT)}this.firstFocused=false;this.hideCauseBlur=true};function DPC_onEditControlChange(A){DatePickerControl.onEditControlChange(A)}DatePickerControl.onEditControlChange=function(B){if(B==null){B=window.event}var A=(B.srcElement)?B.srcElement:B.originalTarget;if(A.value==""){return }var C=A.getAttribute("datepicker_format");if(!this.validate(A.value,C)){setTimeout("e = document.getElementById('"+A.id+"'); e.value=''; e.focus()",10)}};function DPC_onEditControlFocus(A){DatePickerControl.onEditControlFocus(A)}DatePickerControl.onEditControlFocus=function(E){if(E==null){E=window.event}var D=(E.srcElement)?E.srcElement:E.originalTarget;var F=D.getAttribute("datepicker_format");var C=D.getAttribute("datepicker_min");this.minDate=C?this.getDateFromString(C,F):null;var A=D.getAttribute("datepicker_max");this.maxDate=A?this.getDateFromString(A,F):null;if(this.maxDate&&this.minDate){if(this.maxDate.getTime()<this.minDate.getTime()){var B=this.maxDate;
this.maxDate=this.minDate;this.minDate=B}}if((!this.displayed||this.hideCauseBlur)&&this.autoShow&&!this.firstFocused){clearTimeout(this.hideTimeout);this.hideTimeout=null;this.firstFocused=true;if(this.hideCauseBlur){this.hideCauseBlur=false;this.hide()}this.showForEdit(D)}else{if(this.inputControl&&this.inputControl.id!=D.id){this.hide()}else{if(this.hideTimeout){clearTimeout(this.hideTimeout);this.hideTimeout=null}}}};function DPC_onFormSubmit(A){DatePickerControl.onFormSubmit(A)}DatePickerControl.onFormSubmit=function(A){if(this.submitByKey){this.submitByKey=false;if(this.displayed&&this.currentDay>0){this.writeDate(this.currentDay);if(A==null){A=window.event}var B=(A.srcElement)?A.srcElement:A.originalTarget;if(A.stopPropagation){A.stopPropagation()}if(A.preventDefault){A.preventDefault()}A.returnValue=false;A.cancelBubble=true;return false}}this.reformatOnSubmit()};DatePickerControl.reformatOnSubmit=function(){if(this.submitFormat==""){return true}var A=document.getElementsByTagName("input");var E=A.length;var C;for(C=0;C<E;C++){if(A[C].type.toLowerCase()=="text"){var F=A[C];if(F.value==""){continue}var G=F.getAttribute("isdatepicker");if(G&&G=="true"){var H=this.getDateFromControl(F);var B=this.submitFormat.replace("DD",H.getDate());var D=H.getMonth()+1;B=B.replace("MM",D.toString());if(this.submitFormat.indexOf("YYYY")>=0){B=B.replace("YYYY",H.getFullYear())}else{B=B.replace("YY",H.getFullYear())}F.value=B}}}return true};function DPC_formSubmit(){var A=DatePickerControl.reformatOnSubmit();if(this.submitOrig){A=this.submitOrig()}return A}function DPC_onWindowResize(A){DatePickerControl.onWindowResize(A)}DatePickerControl.onWindowResize=function(A){this.relocate();this.relocateButtons()};DatePickerControl.relocateButtons=function(){var E=document.getElementsByTagName("div");for(key in E){if(E[key].id&&E[key].id.indexOf(this.buttonIdPrefix)==0){var C=E[key];if(C.style.display=="none"){continue}var A=document.getElementById(C.getAttribute("datepicker_inputid"));if(A.style.display=="none"||A.offsetTop==0){continue}var B=getObject.getSize("offsetTop",A);var D=getObject.getSize("offsetLeft",A);C.style.top=(B+Math.floor((A.offsetHeight-C.offsetHeight)/2)+this.buttonOffsetY)+"px";var F=Math.floor((A.offsetHeight-C.offsetHeight)/2);if(this.buttonPosition=="in"){C.style.left=(D+A.offsetWidth-C.offsetWidth-F+this.buttonOffsetX)+"px"}else{C.style.left=(D+A.offsetWidth+F+this.buttonOffsetX)+"px"}}}};DatePickerControl.relocate=function(){if(this.displayed){var A=this.inputControl;if(A==null){return }var C=getObject.getSize("offsetTop",A);var B=getObject.getSize("offsetLeft",A);this.calContainer.style.top=C+A.offsetHeight+this.offsetY+"px";this.calContainer.style.left=B+this.offsetX+"px";if(this.calBG){this.calBG.style.top=this.calContainer.style.top;this.calBG.style.left=this.calContainer.style.left}}};DatePickerControl.getWeekNumber=function(H,F,J){var G=new Date(H,F,J);var C=new Date(H,0,1);var E=7+1-C.getDay();if(E==8){E=1}var B=((Date.UTC(y2k(H),G.getMonth(),G.getDate(),0,0,0)-Date.UTC(y2k(H),0,1,0,0,0))/1000/60/60/24)+1;var D=Math.floor((B-E+7)/7);if(D==0){H--;var A=new Date(H,0,1);var I=7+1-A.getDay();if(I==2||I==8){D=53}else{D=52}}return D};function y2k(A){return(A<1000)?A+1900:A}function getObject(A){if(bw.dom){this.hElement=document.getElementById(A);this.hStyle=this.hElement.style}else{if(bw.ns4){this.hElement=document.layers[A];this.hStyle=this.hElement}else{if(bw.ie){this.hElement=document.all[A];this.hStyle=this.hElement.style}}}}getObject.getSize=function(sParam,hLayer){nPos=0;while(hLayer&&(hLayer.tagName)&&!(/(body|html)/i.test(hLayer.tagName))){nPos+=eval("hLayer."+sParam);if(sParam=="offsetTop"){if(hLayer.clientTop){nPos+=hLayer.clientTop}}if(sParam=="offsetLeft"){if(hLayer.clientLeft){nPos+=hLayer.clientLeft}}hLayer=hLayer.offsetParent}return nPos};function writeLayer(ID,parentID,sText){if(document.layers){var oLayer;if(parentID){oLayer=eval("document."+parentID+".document."+ID+".document")}else{oLayer=document.layers[ID].document}oLayer.open();oLayer.write(sText);oLayer.close()}else{if(document.all){document.all[ID].innerHTML=sText}else{document.getElementById(ID).innerHTML=sText}}};