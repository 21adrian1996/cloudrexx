<!-- start module_fileBrowser_content.html -->
<script language="javascript" type="text/javascript">
webPath = '{FILEBROWSER_IMAGE_PATH}';
maxWidth = 180;
maxHeight = 180;

function getParam( name )
{
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )
    return "";
  else
    return results[1];
}

function setUrl(url, width, height, alt, type) {
    var ckFuncNum = getParam('CKEditorFuncNum');
    
    // Check if the user requested the fileBrowser from within the CKeditor
    if(ckFuncNum !== "") {
        window.opener.CKEDITOR.tools.callFunction(parseInt(ckFuncNum), webPath+url, function() {
            // Get the reference to the CKeditor's dialog window.
            var element, dialog = this.getDialog();

            // Check if the user is intending to create a html link (called from within the CKeditor's link dialog)
            if (   dialog.getName() == 'link'
                && type == 'page') {
                // Get the reference to the protocol attribute
                element = dialog.getContentElement( 'info', 'protocol' );

                // Content pages are in the form [[NODE_1]],
                // therefore set the protocol 'other'
                if (element) {
                    element.setValue('');
                }
            }
        });
    }
    else {
	    window.opener.SetUrl( webPath+url, width, height, alt );
	    if (window.opener.document.getElementById('cmbLinkProtocol') !== null && {FILEBROWSER_NOT_ABSOLUTE_URI}) {
            window.opener.document.getElementById('cmbLinkProtocol').value = '';
        }
	}
	window.opener.focus();
	window.top.close();
}

var aFileBrowserFiles = [{FILEBROWSER_FILES_JS}];

function showPreview(fileNr, width, height) {
	if (fileNr === '') {
		document.getElementById('fileBrowserPreview').src = 'images/pixel.gif';
		document.getElementById('fileBrowserPreview').width = maxWidth;
		document.getElementById('fileBrowserPreview').height = maxHeight;
	} else {
		if (width > maxWidth || height > maxHeight) {
			if (width > height) {
				factor = width/maxWidth;
				width = maxWidth;
				height = height/factor;
			} else {
				factor = height/maxHeight;
				height = maxHeight;
				width = width/factor;
			}
		}

		document.getElementById('fileBrowserPreview').style.width = width+'px';
		document.getElementById('fileBrowserPreview').style.height = height+'px';
		document.getElementById('fileBrowserPreview').src = webPath + aFileBrowserFiles[fileNr];
	}
}
</script>
<div style="height:500px; overflow:auto;">
	<table border="0" cellpadding="0" cellspacing="0" class="adminlist" id="contentList" summary="directory listing">
		<tbody>
			<!-- BEGIN content_files -->
				<tr class="{FILEBROWSER_ROW_CLASS}" {FILEBROWSER_ROW_STYLE}>
					<td width="75%" height="20" style="padding-left:1px;">{FILEBROWSER_SPACER}<a href="{FILEBROWSER_FILE_PATH_CLICK}" ondblclick="{FILEBROWSER_FILE_PATH_DBLCLICK}" title="{FILEBROWSER_FILE_NAME}"><img src="{FILEBROWSER_FILE_ICON}" width="16" height="16" border="0" alt="{FILEBROWSER_FILE_NAME}" />&nbsp;{FILEBROWSER_FILE_NAME}</a></td>
					<td width="15%" height="20" style="text-align:right;">{FILEBROWSER_FILE_DIMENSION}</td>
					<td width="10%" height="20" style="text-align:right; padding-right:1px;">{FILEBROWSER_FILESIZE}</td>
				</tr>
			<!-- END content_files -->
		</tbody>
	</table>
</div>
<!-- end module_fileBrowser_content.html -->
